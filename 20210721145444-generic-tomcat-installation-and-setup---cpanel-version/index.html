<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="generator" content="mkdocs-1.6.1, mkdocs-terminal-4.7.0">
     
     
    <link rel="icon" type="image/png" sizes="192x192" href="../img/android-chrome-192x192.png" />
<link rel="icon" type="image/png" sizes="512x512" href="../img/android-chrome-512x512.png" />
<link rel="apple-touch-icon" sizes="180x180" href="../img/apple-touch-icon.png" />
<link rel="shortcut icon" type="image/png" sizes="48x48" href="../img/favicon.ico" />
<link rel="icon" type="image/png" sizes="16x16" href="../img/favicon-16x16.png" />
<link rel="icon" type="image/png" sizes="32x32" href="../img/favicon-32x32.png" />


    
 
<title>Generic Tomcat Installation and Setup - cPanel version - notes</title>


<link href="../css/fontawesome/css/fontawesome.min.css" rel="stylesheet">
<link href="../css/fontawesome/css/solid.min.css" rel="stylesheet">
<link href="../css/normalize.css" rel="stylesheet">
<link href="../css/terminal.css" rel="stylesheet">
<link href="../css/theme.css" rel="stylesheet">
<link href="../css/theme.tile_grid.css" rel="stylesheet">
<link href="../css/theme.footer.css" rel="stylesheet">
<!-- dark color palette -->
<link href="../css/palettes/dark.css" rel="stylesheet">

<!-- page layout -->
<style>
/* initially set page layout to a one column grid */
.terminal-mkdocs-main-grid {
    display: grid;
    grid-column-gap: 1.4em;
    grid-template-columns: auto;
    grid-template-rows: auto;
}

/*  
*   when side navigation is not hidden, use a two column grid.  
*   if the screen is too narrow, fall back to the initial one column grid layout.
*   in this case the main content will be placed under the navigation panel. 
*/
@media only screen and (min-width: 70em) {
    .terminal-mkdocs-main-grid {
        grid-template-columns: 4fr 9fr;
    }
}</style>



     
    
    

    
    <!-- search css support -->
<link href="../css/search/bootstrap-modal.css" rel="stylesheet">
<!-- search scripts -->
<script>
    var base_url = "..",
    shortcuts = "{}";
</script>
<script src="../js/jquery/jquery-1.10.1.min.js" defer></script>
<script src="../js/bootstrap/bootstrap.min.js" defer></script>
<script src="../js/mkdocs/base.js" defer></script>
    
    
    
    
    <script src="../search/main.js"></script>
    

    
</head>

<body class="terminal"><div class="container">
    <div class="terminal-nav">
        <header class="terminal-logo">
            <div id="mkdocs-terminal-site-name" class="logo terminal-prompt"><a href="/" class="no-style">notes</a></div>
        </header>
        
        <nav class="terminal-menu">
            
        </nav>
    </div>
</div>
        
    <div class="container">
        <div class="terminal-mkdocs-main-grid"><aside id="terminal-mkdocs-side-panel"><nav>
  
</nav><hr>
<nav>
    <ul>
        <li><a href="#resources">Resources</a></li>
        <li><a href="#installation">Installation</a></li>
        <li><a href="#removal">Removal</a></li><li><a href="#configuration">Configuration</a></li>
        <li><a href="#enable-for-cpanel-user">Enable for cPanel User</a></li><li><a href="#user-specific-configuration-files">User-Specific Configuration Files</a></li><li><a href="#check-assigned-ports">Check Assigned Ports</a></li><li><a href="#apache-proxy-setup">Apache Proxy Setup</a></li><li><a href="#stoprestart">Stop/Restart</a></li>
        <li><a href="#enable-startstop-for-cpanel-users">Enable Start/Stop for cPanel Users</a></li><li><a href="#testing-the-setup">Testing the Setup</a></li>
        <li><a href="#explanation-of-tomcat-under-cpanel">Explanation of Tomcat under cPanel</a></li>
        
    </ul>
</nav>
</aside>
            <main id="terminal-mkdocs-main-content">
    
    
    
    
    

<section id="mkdocs-terminal-content">
    <h2 id="resources">Resources<a class="headerlink" href="#resources" title="Anchor link to this section for reference">#</a></h2>
<p>cPanel Documentation:
* <a href="https://docs.cpanel.net/ea4/tomcat/tomcat/">Introduction to Tomcat</a>
* <a href="https://docs.cpanel.net/ea4/tomcat/tomcat-proxies/">Tomcat Proxies</a>
* <a href="https://docs.cpanel.net/ea4/tomcat/tomcat-private-instances/">Tomcat Private Instances</a></p>
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Anchor link to this section for reference">#</a></h2>
<p>You can install Tomcat through EasyApache 4 in WHM or on the CLI with:</p>
<pre><code>yum -y install ea-tomcat85
</code></pre>
<h3 id="removal">Removal<a class="headerlink" href="#removal" title="Anchor link to this section for reference">#</a></h3>
<p>Removal can be done through EasyApache 4 in WHM or on the CLI with:</p>
<pre><code>yum -y remove ea-tomcat85
</code></pre>
<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Anchor link to this section for reference">#</a></h2>
<h3 id="enable-for-cpanel-user">Enable for cPanel User<a class="headerlink" href="#enable-for-cpanel-user" title="Anchor link to this section for reference">#</a></h3>
<pre><code>/usr/local/cpanel/scripts/ea-tomcat85 add &lt;cpuser&gt;
</code></pre>
<h3 id="user-specific-configuration-files">User-Specific Configuration Files<a class="headerlink" href="#user-specific-configuration-files" title="Anchor link to this section for reference">#</a></h3>
<pre><code>/home/&lt;cpuser&gt;/ea-tomcat85/conf
</code></pre>
<p><em>Note: The cPanel user must be added to the Tomcat user list with the <code>add</code>
command above. Until then the _ea-tomcat85</em> folder doesn't exist._</p>
<h3 id="check-assigned-ports">Check Assigned Ports<a class="headerlink" href="#check-assigned-ports" title="Anchor link to this section for reference">#</a></h3>
<p>When you add the user to the Tomcat Manager the user is automatically assinged 2
ports for the Tomcat setup. To determine what those ports are run:</p>
<pre><code>cat /etc/cpanel/cpuser_port_authority.json | grep -B 1 &lt;cpuser&gt;
</code></pre>
<p>This will return the user and the ports assigned to that user. It should look
somethign like this:</p>
<pre><code>   &quot;10000&quot; : {
    &quot;owner&quot; : &quot;cpuser&quot;,
--
   &quot;10001&quot; : {
    &quot;owner&quot; : &quot;cpuser&quot;,
</code></pre>
<p>In this case, ports 10000 and 10001 have been assigned to the cPanel user
<em>cpuser</em>. These ports must be opened in the firewall if a proxy is <em>not</em> going
to be set up for use. Otherwise, the ports can remain closed. </p>
<h3 id="apache-proxy-setup">Apache Proxy Setup<a class="headerlink" href="#apache-proxy-setup" title="Anchor link to this section for reference">#</a></h3>
<p>You can follow the steps in this guide.</p>
<h2 id="stoprestart">Stop/Restart<a class="headerlink" href="#stoprestart" title="Anchor link to this section for reference">#</a></h2>
<p><em>Note: This applies to all cPanel users configured to use Tomcat.</em></p>
<pre><code>/usr/local/cpanel/scripts/ea-tomcat85 all restart
</code></pre>
<h3 id="enable-startstop-for-cpanel-users">Enable Start/Stop for cPanel Users<a class="headerlink" href="#enable-startstop-for-cpanel-users" title="Anchor link to this section for reference">#</a></h3>
<p>To enable the ability for users to start/stop/status of Tomcat, add the
following to the users <code>.bashrc</code> file:</p>
<pre><code>export PATH=$(dirname $(readlink /usr/local/cpanel/3rdparty/bin/perl)):$PATH
</code></pre>
<p>Make sure you add this to the <code>~/.bashrc</code> file for the user:</p>
<pre><code>echo &quot;export PATH=$(dirname $(readlink /usr/local/cpanel/3rdparty/bin/perl)):$PATH&quot; &gt;&gt; ~/.bashrc
</code></pre>
<p>Then, the user can run the following commands:</p>
<pre><code>ubic status ea-tomcat85
ubic start ea-tomcat85
ubic stop ea-tomcat85
ubic restart ea-tomcat85
</code></pre>
<h2 id="testing-the-setup">Testing the Setup<a class="headerlink" href="#testing-the-setup" title="Anchor link to this section for reference">#</a></h2>
<p>To test the Tomcat setup, copy the <em>test.jsp</em> file from the system to the user's
Tomcat directory, as follows:</p>
<pre><code>cp /opt/cpanel/ea-tomcat85/test.jsp /home/&lt;cpuser&gt;/ea-tomcat85/webapps/ROOT
</code></pre>
<p>Then you can visit the site, with <em>test.jsp</em> appended, to see the setup.</p>
<h2 id="explanation-of-tomcat-under-cpanel">Explanation of Tomcat under cPanel<a class="headerlink" href="#explanation-of-tomcat-under-cpanel" title="Anchor link to this section for reference">#</a></h2>
<p><em>Note: This was written in a way to be able to copy-and-paste to the customer.</em></p>
<blockquote>
<p>The way that Tomcat has been installed on the domain is done as a Private Instance of Tomcat and as a result, it's more secure, which also includes integration into WHM and cPanel.  There's no Tomcat Manager as a result since the Tomcat Manager is for all users on the server, whereas Tomcat installed on the domain is strictly for the cPanel user and nobody else.</p>
<p>To gain access to the Tomcat Manager for the whole server, you need to login to Root WHM and search, under the WHM logo, for "tomcat" and you'll see Tomcat Manager.</p>
<p>The location where Tomcat applications are deployed in this installation is at (note the <cpuser> entry is where the cPanel username should be):</p>
<p>/home/<cpuser>/ea-tomcat85/webapps/ROOT/</p>
<p>The installation of Tomcat onto the whole server is done completely separate from WHM/cPanel and as a result provides you with access to the Tomcat Manager as a completely separate, isolated login from WHM and cPanel.  This confirmation is less secure as a result because anyone could have access to the Tomcat Manager since it's fully public-facing.</p>
<p>The location of where you need to place your Tomcat applications for this type of installation would be something like:</p>
<p>/opt/tomcat85/webapps/ROOT/</p>
<p>Which requires Root access via the command line or FTP in order to manage since no cPanel user’s File Manager application can access this location.</p>
</blockquote>
</section>

<section id="mkdocs-terminal-after-content">
    
</section>

            </main>
        </div>
        <hr><footer>
    <div class="terminal-mkdocs-footer-grid">
        <div id="terminal-mkdocs-footer-copyright-info">
             Site built with <a href="http://www.mkdocs.org">MkDocs</a> and <a href="https://github.com/ntno/mkdocs-terminal">Terminal for MkDocs</a>.
        </div>
    </div>
</footer>
    </div>

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="alertdialog" aria-modal="true" aria-labelledby="searchModalLabel">
    <div class="modal-dialog modal-lg" role="search">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="searchModalLabel">Search</h5>
                <button type="button" class="close btn btn-default btn-ghost" data-dismiss="modal"><span aria-hidden="true">x</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p id="searchInputLabel">Type to start searching</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" aria-labelledby="searchInputLabel" placeholder="" id="mkdocs-search-query" title="Please enter search terms here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No document matches found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
    
    
</body>

</html>